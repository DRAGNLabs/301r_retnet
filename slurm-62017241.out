Training with lr=0.01, dropout=0.1, embed_dim=768, batch_size=16
1200

Model Summary:
====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
RetNetModel                                        [1, 512, 10000]           --
├─RetNetDecoder: 1-1                               [1, 512, 10000]           --
│    └─Embedding: 2-1                              [1, 512, 768]             7,680,000
│    └─Dropout: 2-2                                [1, 512, 768]             --
│    └─RetNetRelPos: 2-3                           [512, 256]                --
│    └─ModuleList: 2-4                             --                        --
│    │    └─DecoderLayer: 3-1                      [1, 512, 768]             6,895,104
│    │    └─DecoderLayer: 3-2                      [1, 512, 768]             6,895,104
│    │    └─DecoderLayer: 3-3                      [1, 512, 768]             6,895,104
│    │    └─DecoderLayer: 3-4                      [1, 512, 768]             6,895,104
│    │    └─DecoderLayer: 3-5                      [1, 512, 768]             6,895,104
│    │    └─DecoderLayer: 3-6                      [1, 512, 768]             6,895,104
│    │    └─DecoderLayer: 3-7                      [1, 512, 768]             6,895,104
│    │    └─DecoderLayer: 3-8                      [1, 512, 768]             6,895,104
│    │    └─DecoderLayer: 3-9                      [1, 512, 768]             6,895,104
│    │    └─DecoderLayer: 3-10                     [1, 512, 768]             6,895,104
│    │    └─DecoderLayer: 3-11                     [1, 512, 768]             6,895,104
│    │    └─DecoderLayer: 3-12                     [1, 512, 768]             6,895,104
│    └─RMSNorm: 2-5                                [1, 512, 768]             768
│    └─Linear: 2-6                                 [1, 512, 10000]           7,680,000
====================================================================================================
Total params: 98,102,016
Trainable params: 98,102,016
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 18.18
====================================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 517.54
Params size (MB): 392.41
Estimated Total Size (MB): 909.95
====================================================================================================

Saving weights in /home/calvin35/CS301R/301r_retnet/weights/2024-01-12-11:47:49_retnet_98102016

Estimated Loss if guessing:
-log(1 / 10000) = 9.21034049987793
Traceback (most recent call last):
  File "/home/calvin35/CS301R/301r_retnet/grid_search.py", line 24, in <module>
    retnet_model, avg_loss_retnet = train_model(dropout=dropout,
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/calvin35/CS301R/301r_retnet/train_model.py", line 291, in train_model
    model = (model).to(device)
            ^^^^^^^^^^^^^^^^^^
  File "/home/calvin35/CS301R/301r_retnet/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/calvin35/CS301R/301r_retnet/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/calvin35/CS301R/301r_retnet/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/calvin35/CS301R/301r_retnet/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/calvin35/CS301R/301r_retnet/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/calvin35/CS301R/301r_retnet/venv/lib/python3.11/site-packages/torch/cuda/__init__.py", line 298, in _lazy_init
    torch._C._cuda_init()
RuntimeError: The NVIDIA driver on your system is too old (found version 11040). Please update your GPU driver by downloading and installing a new version from the URL: http://www.nvidia.com/Download/index.aspx Alternatively, go to: https://pytorch.org to install a PyTorch version that has been compiled with your version of the CUDA driver.
